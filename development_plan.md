## 開発手順書（お薬飲み忘れ防止 Webアプリ）

`requirements.md` をベースに、初心者でも進めやすい 4 段階のステップでまとめています。各ステップごとに動作確認ポイントを用意し、30% → 50% → 70% → 100% の順で完成度を上げます。

---

### ステップ1（30%）：土台づくり
**目的**: アプリの骨組みを作り、基本画面とデータ構造を整える。

1. **環境準備**
   - Node.js / npm をインストール。
   - Next.js もしくは Expo + React Native Web で新規プロジェクト作成。
   - Git でバージョン管理開始（GitHub 連携推奨）。
2. **基本レイアウト**
   - ホーム画面に「ユーザー選択」「時間帯選択」「薬一覧（仮）」を配置。
   - レスポンシブ対応（iPhone 画面幅で確認）。
3. **データ設計**
   - ユーザー、薬、スケジュールのデータ構造を JSON で定義。
   - 仮データを `src/data/sample.ts` などに置いてモック表示。

**動作確認**
- Next.js 16.0 を使う場合は `npm run dev -- --webpack`、それ以外は `npm run dev` を実行し、iPhone シミュレーター（Safari デバッガ）や実機で画面が崩れないか確認。
- ユーザーや時間帯を切り替えると、画面表示が変わることを確認。

---

### ステップ2（50%）：登録・編集フロー
**目的**: 実際に薬やスケジュールを登録・編集できる画面を作成し、データ保存を実装。

1. **フォーム実装**
   - ユーザー追加/編集フォーム（名前・写真URLなど）。
   - 薬登録フォーム（薬名、個数、表面/裏面画像アップロード）。
   - スケジュール設定フォーム（時間帯ごとの薬・個数）。
2. **データ保存**
   - IndexedDB or LocalStorage に保存する仕組みを追加。
   - 保存成功/失敗のトースト表示。
3. **リスト表示**
   - 登録済みの薬やスケジュールを一覧表示し、編集・削除ボタンを設置。

**動作確認**
- フォーム入力→保存→再読み込みしてもデータが残るかチェック。
- 編集・削除が反映されるか確認。
- エラーメッセージや入力チェックが正しく表示されるか確認。

---

### ステップ3（70%）：カメラ判定プロトタイプ
**目的**: カメラで撮影した画像を既存データと照合し、結果表示の流れを構築。

1. **カメラアクセス**
   - PWA 化（`manifest.json` + `service worker`）でホーム画面追加をサポート。
   - `getUserMedia` でカメラ起動ボタンを実装（Safari で許可ダイアログ確認）。
2. **画像処理モック**
   - TensorFlow.js などを導入し、登録画像と撮影画像を比較する枠組みを用意。
   - 初期は「同じ薬」と判定するダミーロジックでも可。
3. **結果表示UI**
   - 判定結果を「OK / 不足 / 過剰 / 誤薬」で表示。
   - 詳細メッセージ（例: `ビタミンCが1個足りません`）を表示。

**動作確認**
- カメラが正常に起動し、撮影プレビューに登録薬が表示されるか確認。
- ダミーロジックでも、結果画面にメッセージが表示されるか確認。
- オフライン状態でも最低限の画面遷移ができるか確認。

---

### ステップ4（100%）：本番品質 & 追加便利機能
**目的**: 判定精度を高め、全体の完成度を上げてデプロイ可能な状態にする。

1. **画像判定精度向上**
   - 登録時に表/裏の特徴を抽出し、照合アルゴリズムを改善。
   - 必要に応じてクラウド推論 API（Vision API など）を追加。
   - テスト用に複数パターンの登録画像を用意して検証。
2. **履歴・再判定**
   - 判定履歴を日付/時間帯ごとに保存。
   - 同じタイムスロットで再判定できるボタンを追加。
3. **デプロイ**
   - Vercel / Netlify にデプロイ。
   - HTTPS、PWA インストール確認、iPhone 実機テスト。
4. **QA & ドキュメント**
   - 動作確認チェックリスト（機能テスト・UI テスト）。
   - ユーザー向け簡易マニュアル（スクリーンショット付き）。

**動作確認**
- 実機で判定精度テスト（朝/昼/夜/就寝前の全パターン）。
- 多ユーザー（最大5人）、複数薬・個数パターンで判定。
- デプロイ先でエラーなく動作し、PWA としてホーム画面から起動できるか確認。

---

### 補足
- 各ステップ完了ごとに Git のタグやブランチを切り、状態を固定しておくと後戻りしやすいです。
- 判定モデルの学習は最初はシンプルにし、利用状況に合わせて精度を高めていく方針を推奨します。

