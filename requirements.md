## 要件定義書（お薬飲み忘れ防止 Webアプリ）

### 1. 目的
- 複数人の服薬予定を iPhone で確認・管理できる Web アプリを提供する。
- 登録済みの薬と、机に並べた薬をカメラ撮影で照合し、過不足や間違いを即時判定する。

### 2. 対象ユーザー
- 家庭内で薬を複数人分管理する人（最大5名想定）。
- 非エンジニア・IT初心者でも操作できること。

### 3. 利用シナリオ
- 朝/昼/夜/就寝前/毎食 の各タイミングに、登録済みスケジュールに従って薬をセット。
- カメラで撮影→アプリが自動判定→不足・余剰・誤薬があれば指摘。
- 服薬計画の追加・編集・削除を簡単に実施。

### 4. 機能要件
1. **ユーザー管理**
   - 最大5人までのプロファイル（名前・写真任意）。
   - 各ユーザーにタイムスロット別の服薬予定を登録。
2. **薬登録**
   - 薬名、服用個数、表面と裏面の画像2枚登録。
   - 必要に応じて備考（注意書き）を保存。
3. **服薬スケジュール管理**
   - 時間帯ごとに、薬の種類・数量を設定。
   - 同じ薬を複数個登録可能、追加・編集・削除を簡単に。
4. **カメラ撮影・画像判定**
   - iPhone Safari/ホーム画面アプリ化(PWA)でカメラアクセス。
   - 撮影画像を登録画像と照合し、薬種・数量を自動判別。
   - 判定結果を「不足」「過剰」「誤薬」「完了」で表示。
5. **結果表示・通知**
   - 不足例: 「〇〇が1個足りません」
   - 過剰例: 「〇〇が1個多く並んでいます」
   - 誤薬例: 「登録されていない薬が含まれています」
   - ステップ完了時に「準備OK」を表示。
6. **履歴・再チェック**
   - 同一タイムスロットで再判定可能。
   - 直近の判定履歴を保存（24時間程度）。

### 5. 非機能要件
- **操作性**: iPhoneでの片手操作、直感的UI、文字大きめ。
- **パフォーマンス**: 撮影から判定まで5秒以内目標。
- **信頼性**: ネットワーク不安定でも最低限の閲覧/編集可能。
- **セキュリティ**: ローカル保存中心、バックアップ用にクラウド同期(任意)。
- **保守性**: 薬やスケジュールの追加・変更作業を3タップ以内で完了。

### 6. 技術要件（例）
- フロント: React + Next.js or Expo + React Native Web（PWA対応）。
- 画像判定: 軽量なオンデバイスML（TensorFlow.js/Mediapipe）＋クラウド推論API(オプション)。
- データ保存: IndexedDB/LocalStorage + 任意でSupabase/Firebase。
- デプロイ: Vercel / Netlify などゼロダウンタイムのホスティング。

### 7. 依存・前提
- 登録画像は背景・明るさを揃えるガイドを用意。
- iOS Safariのカメラ権限許可が必要。
- 初期学習データはユーザー登録画像を利用（転移学習で精度向上）。

### 8. 品質指標
- 判定精度: 登録済み薬の認識率90%以上を目標。
- エラー: デプロイ環境でビルド・実行エラーゼロ。
- Uptime: 99%（ホスティング依存）。

### 9. 今後の拡張案
- プッシュ通知/リマインダー連携。
- 飲んだ後のチェックイン機能。
- 家族や医師との共有リンク。
- 音声案内・多言語対応。

